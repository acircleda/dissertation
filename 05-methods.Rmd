
# CHAPTER THREE: Research Design and Methods

This chapter draws on the conceptual framework and prior research to outline quantitative methods that will be used to answer the primary research questions. In order to answer these questions, the methods are divided into two phases, reflecting micro- and macro-level data. Phase one refers to the estimation of PISA scientific literacy scores per country per three-year cycle. Phase two refers to building a model to estimate CO~2 emissions over time.

## Phase One: PISA Scientific Literacy Scores

### How PISA Scores are Estimated

In order to estimate scientific literacy scores correctly, the psychometric and testing properties of the PISA must be taken into account. Recall that the goal of the PISA is to measure the ability of 15-year-olds in applying their reading, math, and science literacy skills to real life, at an international scale. However, the PISA is not a measure of *individual* abilities. Instead, PISA results are meant to be representative of the nations and economies from which students are tested. 

Because the OECD cannot assess every student in every country, the PISA generally employs a two-stage stratified sampling design where schools are sampled within a country and then students sampled within schools [@oecd2012, p. 61-84]. This ensures nationally representative samples from which inferences can be made. To aid in this analysis, the PISA provides student sampling weights, which scale the sample up to match the population size), and a set of 80 replicate weights to reduce sampling variance [@oecd2012]. 

Just as the PISA cannot assess every student, it also cannot ask every question to the students it does assess. Within each assessment cycle, there are hundreds of questions drawn from the major and minor domains. Asking every question of every student would be unfeasible. Instead, students take a subset of questions during a two-hour test period. At the end of the assessment cycle, the PISA has generated a mix of observed values - questions students have answered - and missing data - questions students have not answered.

Using the data generated, the ability of students is modeled using Item Response Theory (IRT). IRT models assess the latent abilities of test-takers by estimating the probability of responding to an item correctly. This probability is derived from the relationships between student answers and various item parameters, such as item difficulty, item discrimination, and guessing. Item difficulty refers to the latent ability of an individual required have a 50% chance of answering an item correctly. For example, an item with a difficult of *b* = 0 means an individual with a latent ability of $\theta=0$ (i.e., average ability) has a 50% chance of getting the item correct. Item discrimination refers to the ability of a test item to distinguish between individuals with low and high abilities. Guessing refers to the probability of an individual with a low ability ($\theta < 0$) getting an answer correct [@desjardins2018; @furr2014].

<!-- IRT Steps -->
Prior to 2015, the PISA employed two different IRT models: a Rasch model and a partial credit model (PCM). The Rasch model, which is used to estimate latent ability based on only item difficulty, was fit to dichotomous data. The PCM approach, an extension of the Rasch model, was fit to polytomous data [@oecd2015]. Since 2015, a hybrid approach has been used that first estimates responses using the Rasch and PCM approaches. During this stage item fit is estimated and if poor fit is detected, a model that includes item difficulty and item discrimination is used. For dichotomous data a two parameter model (2PL) is used while a generalized partial credit model (GPCM) is used for polytomous data. These two models are considered more adept at handling the complexities of PISA data. Items are checked across countries to determine if they are functioning differently for that country (an indication of country differential item functioning [DIF]). If so, national item parameters specific to that country are used for estimation [@oecd2017]. 

The end result of this process is a model of student responses that can be used to estimate ability. However, recall that students do not answer all questions and there is inherent missingness to PISA data. What this means is that "student proficiencies (or measures) are not observed; they are missing data that must be inferred from the observed item responses" [@oecd2009, p.153]. Because of this, PISA scores are not meant to represent individual student abilities or to compare individual students but rather be a representative measure of large groups, such as nations [@jerrim2017]. 

Rather than a single ability score, students get a set of 5-10^[10 plausible values were generated for each student starting in 2015] *plausible* values, which represent predicted proficiency.  Plausible values are generated based on the item parameters and a latent regression population model that uses a combination of item response time and student background characteristics. These plausible values are then linearly transformed and placed on a common scale that can be linked across cycles, with a mean of 500 and a standard deviation of 100. 

To calculate the final score of a country (or other grouping, e.g., scores for females or males within a country) for a particular PISA assessment, a weighted mean based on the product of a plausible values and student weights is calculated. For example, scientific literacy plausible value 1 is multiplied by the full student weights to create a mean score for plausible value 1, $\hat\mu_1$. This is then repeated for the remaining plausible values, $\hat\mu_{2...n}$. These values are then averaged to get the final estimated score: $\hat\mu=\frac{1}{5}(\hat\mu_{1}+\hat\mu_{2}...+\hat\mu_{n}$. To generate the error variance of the score requires a combination of the sum of the plausible values' sampling variances and the imputation (measurement error) variance [see @caro2017; @oecd2009a for formulas]. These scores can then be used in further cross-sectional or longitudinal analyses [@aloisi2017; @campbell2021; @lam2021; @nces; @rowley2019a].

### Estimation Method

Scientific literacy scores are estimated for each cycle following the methods outline above and using the `intsvy` R package [@caro2017]. Scores are estimated for all students in each country, and then separately for males and females within each country.

## Phase Two: PISA Scientific Literacy Scores and Emissions Over Time

The research questions suggest a longitudinal model that looks at the relationship between a set of variables over time. Furthermore, the nature of the independent variable, scientific literacy, is represented as repeated measures nested within countries. Therefore the research and data indicate that a multilevel growth model would be most appropriate to answer the key research questions. This method takes advantage of the nested and longitudinal nature of the data, allowing the estimation of fixed and random effects to model different types of change.

A multilevel growth curve model has several advantages over other longitudinal analyses. The ability to fit individual growth curves for each country allows estimation of a model that more closely models reality. The model allows for missing data and does not require every country to have participated in every measurement occasion (i.e., assessment cycle). In addition, these models can include both time-varying and time-invariant covariates, allowing for statistical control over the independent variable. Finally, growth models typically have higher statistical power than other methods [@hox2018, p. 88-89].

In the multilevel growth modeling framework, fixed effects estimate parameters across all countries. A fixed effect for the intercept in a growth model indicates the grand mean of CO~2~ emissions across all countries. A fixed effect for time would indicate a constant rate of change across all countries such that a one-unit increase in time corresponds to an increase in CO~2~ emissions across all countries equal to the parameter for the fixed effect of time. Random effects allow intercepts and slopes to vary at the first level, meaning each country is allowed to have its own intercept and slope. In the multilevel growth model, this is indicated by a random effect variance for the intercept, which estimates between-country variation in CO~2~, and a random effect for the slope, which indicates between-country variation in the rate of change. Furthermore, a correlation between the intercept and slope is also estimated, allowing understanding of the relationship between CO~2~ emissions and rate of change as well as their shape and direction. The addition of a random slope for scientific literacy allows estimation of its effects on CO~2~ emissions for individual countries [@grimm2017; @hoffman2015].

Of particular importance for any multilevel model is proper interpretation of the intercept. All variables should be centered such that when the predictor equals zero it has a meaningful interpretation as part of the intercept. There are several common centering strategies for multilevel models. One strategy is grand-mean centering ($x-\bar{x}$) in which the intercept represents the mean outcome for countries with an average value for predictor *x*. Related, centering can also occur at a specific value ($x-C$) with an intercept interpretation of the mean outcome for countries with that value for the predictor. 

A second strategy is country-mean centering (also known as group-mean centering or centering within cluster). This approach is especially suited for longitudinal data [@hoffman2015]. With country-mean centering, the intercept is interpreted as the average outcome for each country. A country-mean centered variable is calculated as  $x_{ti} - \bar{x_i}$, where the mean of country *i* is subtracted from the value for country *i* at time *t*. This represents the level-1 within-country effect of the variable but discards any between-country information. Thus, a level-2 predictor can also be included to represent between-country variation $\bar{x_i}$. The inclusion of both centered predictors in the model allows estimation of these predictors' main effects separately at both levels. 

The following section describes the variables that will be included in the growth model along with their centering strategies. Table \@ref(tab:vardesc) presents summary statistics for all continuous variables.

### Key Variables

**Dependent Variable**. The dependent variable will be CO~2~ emissions per capita for all countries included in the analysis. Data will be downloaded from the Global Carbon Atlas (http://www.globalcarbonatlas.org/), which provides the most recent data on CO~2~ emissions [@andrew2021; @friedlingstein2021]. Data will be included for 2007, 2010, 2013, 2016, and 2019, representing a one year lag from PISA administration dates. For China, the PISA has only been administered to either single cities (e.g., Shanghai in 2009 and 2012) or city/region groupings (e.g., Beijing, Shanghai, Jiangsu, and Zhejiang in 2018). Because city- and region-level emissions data is not readily available, data will be used for the whole of China. Kosvo has complete data for 2008-2018. Data for Kosovo for the years 2007 and 2019 data comes from the International Energy Agency^[https://www.iea.org/countries/kosovo]. \@ref(fig:co2overtime) displays...

```{r co2overtime, echo=FALSE, message=FALSE, warning=FALSE}
co2_line_graph <- all_data %>% select(country, year, co2) %>%
  group_by(country) %>%
  mutate(mean = mean(co2, na.rm=T)) %>%
  ungroup() %>%
  mutate(rank = rank(-mean),
         top = ifelse(rank <= 25, country, NA),
         highlight = ifelse(is.na(top), NA, co2))

dscale <- viridis::plasma(n = 6)
dscale[6] <- "#787c10"

ggplot()+
  geom_line(data=co2_line_graph,
            aes(x=year, y=co2, group=country), color="grey90")+
  geom_line(data=co2_line_graph,
            aes(x=year, y=highlight, group=country, 
                color=top))+
  ggrepel::geom_label_repel(data = filter(co2_line_graph, year==2018),
            aes(x=2020, y=highlight, group=country, label=country,
                color=top), hjust=0, size=3)+
  stat_summary(data=co2_line_graph,
               aes(x=year, y=co2, color="mean"),
               geom="line", fun="mean", color="black", size=1.2)+
  stat_summary(data=co2_line_graph %>% filter(year==2018),
               aes(x=2019, y=co2, color="mean"), label="Average CO2",
               geom="text", fun="mean", color="black", size=3)+
  scale_x_continuous(breaks=seq(2006,2018,2))+
  coord_cartesian(clip="off")+
  scale_color_manual(values=dscale)+
  theme(legend.position = "none",
        panel.background = element_blank())
  
```


**Independent Variable**. The main independent variable of interest will be PISA scientific literacy scores estimated as described in Phase One. For each assessment cycle, individual countries will have a scientific literacy score for all students combined, and separate scores for males and females. Country-mean centering, along with including the country mean at level-2, will be used to estimate the pure within- and between-country effects. A level-1 variable of within-country scientific literacy will be estimated as the difference between an assessment cycle and the level-2 country mean, $SL_{within}=sl_{ti}-\bar{sl_i}$. A level-2 variable representing the mean scientific literacy score across measurement cycles will be estimated as $SL_{between}=\bar{sl_i}-500$, where 500 represents the OECD average that PISA scores are standardized to. Thus, the intercept will refer to average CO~2~ emissions for a country with an average scientific literacy score. Appendix A, \@ref(tab:sltable) shows detailed information on total, female, and male scientific literacy score per country and cycle as well as the number of students who participated in each cycle. \@ref(fig:pisascores) displays all countries and their overall PISA scientific literacy score for each year.

```{r pisascores, fig.cap="Overall Scientific Literacy Score by Country"}
model_data %>%
  ggplot(aes(y=reorder(country, sl_total),
             x=sl_total,
             color=as.factor(year)))+
  geom_point()+
  xlab("PISA Scientific Literacy Score")+
  ylab(NULL)+
  scale_x_continuous(breaks = seq(300, 600, 50))+
  theme(panel.background = element_blank(),
        axis.ticks = element_blank(),
        panel.grid.major.x = element_line(color="grey80"),
        panel.grid.major.y = element_line(color="grey90"),
        legend.position = "top",
        legend.background = element_blank(),
        legend.key = element_blank())+
  scale_color_manual(values=c(
    "#FED535", "#ABC178", "#8D2048", "#2197A9", "#FF8200"
  ), name="Year")
```



**Time**. The time metric represents the triennial assessment cycles of the PISA, representing the years 2006, 2009, 2012, 2015, 2018. However, for meaningful interpretation of results, assessment cycle is included as a discrete measurement from 0 to 4, with 0 (and thus the intercept) representing the 2006 cycle [@grimm2017]. 

### Time-Varying (Level-1) Covariates

In order to isolate the effects of education on CO~2~ emissions, control variables are included to account for structural forces that have been found to contribute to climate change.

**Population**. Population is a key variable of the *IPAT* formula and a major factor in emissions. Data comes from the World Bank. Data for Taiwan is based on mid-year (June) estimates provided by the Taiwan National Statistics Office^[https://eng.stat.gov.tw/point.asp?index=9] [@republicofchinataiwan]. Population data is scaled by 10 million and mean-centered. The intercept represents a country with average population.

```{r}
all_data %>%
  ggplot(aes(x=pop, y=co2_lag, color=oecd))+
  geom_point()
```


**GDP-PPP Per Capita**. Gross domestic product (purchasing-power parity) per capita is used to control for the positive relationship between economic growth, education, and emissions. This data comes from the World Bank and is presented in 2015 US dollars. GDP per capita data for Taiwan is missing from the World Bank. Instead, data from the Taiwanese government's National Statistics office is used [@republicofchinataiwan]. This data is in US dollars (no date available). All GDP per capita data is time-varying. It is scaled by $10,000 dollars and grand-mean centered, with the intercept being interpreted for a country with average GDP per capita.

```{r}
all_data %>%
  ggplot(aes(x=gdp, y=co2_lag, color=oecd))+
  geom_point()
```



**Exports and Manufacturing as a Percentage of GDP**. Separate variables for exports as a percentage of GDP and manufacturing as a percentage of GDP serve as additional statistical controls for structural forces of carbon emissions. In particular, they are included as an attempt to control for the offloading of emission-intensive labor to less developed countries [@jorgenson2013; @jorgenson2018; @liobikiene2018] This data comes from the World Bank. This time-varying variable will be grand-mean centered, with the intercept being interpreted for a country with average exports and manufacturing as a percentage of GDP.

```{r}
all_data %>%
  ggplot(aes(x=exports, y=co2_lag, color=oecd))+
  geom_point()
```

```{r}
all_data %>%
  ggplot(aes(x=mfg, y=co2_lag, color=oecd))+
  geom_point()
```


**Gini**. The Gini coefficient will be used to measure wealth inequality, as inequality has been demonstrated to relate to emissions [e.g., @jorgenson2017; @jorgenson2018]. The Gini coefficient is measured on a scale from 0 (perfect equality) to 1 (maximal inequality). Data comes from the Standardized World Income Inequality Database [SWIID version 9.2; @solt2020]. The SWIID is based on the Gini and similar measures. It provides a standardized and complete measure that is comparable across time and countries. Time-varying Gini coefficients are grand-mean centered, indicating a country with average wealth inequality.

```{r}
all_data %>%
  ggplot(aes(x=gini, y=co2_lag, color=oecd))+
  geom_point()
```

**Left-Right Political Ideology**. One of the largest influences on climate change beliefs is political ideology. Following Czarnek et al.'s [-@czarnekRightwingIdeologyReduces2021] methods, data from the Integrated Values Survey (an integration of the European Values Survey and the World Values Survey) is used as a measure of ideology. For their analyses, @czarnekRightwingIdeologyReduces2021 used a question that asked respondents to place themselves on the left-right scale. However, left-right scale placement questions may not be interpreted the same across countries and cultures [@zuell2019]. @czarnekRightwingIdeologyReduces2021 also constructed a scale on group of questions related to cultural or economic values that could represent the left-right scale. However, no factor analysis or correlational analysis was conducted to indicate the chosen questions represented the same underlying construct.
  For this research, eleven questions from the IVS were chosen, including questions selected by @czarnekRightwingIdeologyReduces2021. A series of factor analyses suggested that three questions loaded highly on a single factor that could represent left-right placement (see Appendix B). These questions reflected beliefs about homosexuality, abortion, and women's right to work. A scale score was constructed by averaging across these questions to get each respondent's placement on the left-right scale. After scaling the variable, the mean of individuals per country per wave is calculated. The Values surveys gather responses from a country during a single year within multi-year waves. Therefore, there is missing data on years not surveyed during a particular wave. Missing data during a wave is filled based on the observation within that wave. For example, the value from 2011 is applied for all years within the 2010-2014 wave.

```{r}
all_data %>%
  ggplot(aes(x=left_right_fa, y=co2_lag, color=oecd))+
  geom_point()
```



**Democracy Index**. A democracy index score from the Varieties of Democracies (V-Dem) Project [@mm2021; @VDemV11] is included to control for political effects on carbon emissions [@povitkina2018]. Specifically, the data uses V-Dem's electoral democracy index (polyarchy). This measure is seen as "an essential element of any other conception of representative democracy" [@Vdemcodebook2021, p. 43] and thus the best underlying measure of democracy [@boese2019]. The index ranges from 0 to 1, low (or no) to high electoral democracy. Data is be grand-mean centered, with the intercept referring to a country with an average democracy score.

```{r}
all_data %>%
  ggplot(aes(x=democracy, y=co2_lag, color=oecd))+
  geom_point()
```


**Political Corruption Index**. The Political Corruption Index also comes from the V-Dem Project and was cited as an influential variable in understanding the extent to which a government may influence emissions [@povitkina2018]. This data is also time-varying and grand-mean centered.

```{r}
all_data %>%
  ggplot(aes(x=corruption, y=co2_lag, color=oecd))+
  geom_point()
```

**Net Enrollment in Secondary Education**. Net enrollment of secondary students refers to the ratio of secondary students enrolled to the population of secondary school-aged children. This data comes from both the World Bank and the PISA Coverage Index 3. The coverage index 3 represents the percentage of the 15-year-old population covered by the PISA exam. Lower rates indicate a lower percentage of the population is enrolled in school [@gamboa2015]. Because both sources of net enrollment have extensive misisng data (30% or higher), and because they are similar in definition and share a high correlation averaged across years (*r* = .72), missing data from the PISA coverage index was replaced with World Bank net enrollment data. This provides a more complete data set with only 18% missing data. The remaining data is imputed. This time-varying variable is grand-mean centered, referring to countries with average net enrollment.

```{r}
all_data %>%
  ggplot(aes(x=net_enrollment_corrected, y=co2_lag, color=oecd))+
  geom_point()
```

**OECD**. Past research has used various indicators to model or control for effects of a country's development status [e.g., @czarnekRightwingIdeologyReduces2021; @kelly2020; @lee2020; @mcgee2020]. Countries that are members of the OECD are typically more developed, higher income countries in the Global North [@oecdlist]. The PISA designates countries as OECD countries or partner countries to represent their development status [@bloem2013]. Thus OECD status will serve as a measure of development. This variable will indicate whether a country is a member of the OECD (the reference group) or not, as classified by the PISA. For a majority of countries included over this 12-year period, OECD has been time-invariant. However, several countries became OECD members during this period, especially in 2010. Therefore, OECD status is treated as time-varying. OECD countries will serve as the reference group for this variable. \@ref(tab:sltable) in Appendix A lists each country's OECD status.

### Time-Invariant (Level-2) Variables

**Country**. In total, 98 countries have participated in the PISA at least once since 2006, 65 have participated at least three times, and 51 have participated in all five assessment cycles being analyzed. @hox2018 recommends keeping all cases with missing data, as this data can still contribute to the multilevel analysis (p. 97). However, countries will be removed if they are missing data on the dependent variable. Of the 98 countries, 86 have CO~2~ data and will be retained for the model^[Liechtenstein was removed from the analysis due to missing data for most World Bank-derived variables]. The complete list of countries is available in Appendix A, \@ref(tab:sltable).


**Collectivism-Individualism**. Previous research indicates ideology and worldview plays an important role in influencing a number of climate-change related issues: beliefs, behaviors, mitigation, and emissions [@czarnekRightwingIdeologyReduces2021; @dietz2007a; @hornsey2016; @guy2014; @kahan2013]. While this research covers many permutations of ideology and worldview, most can be categorized as a continuum with the terms left, liberal, egalitarian, communitarian, collectivist on one end and right, conservative, hierarchical, individualist on the other. Because these beliefs exist at the individual level, valid national profiles of ideology are few. 

Hofstede's cultural dimensions serve as a potential measure at this level. These dimensions form a framework for understanding cultural values. Of the six dimensions^[These dimensions include: power distance, individualism vs. collectivism, uncertainty avoidance, masculinity vs. femininity, long-term vs. short-term orientation, and indulgence vs. restraint], the individualism-collectivism continuum has been found to relate the most with climate change, with those with more individualism having higher skepticism [@pelham2018], less concern [@shi2015], and less likely to adapt to natural hazards [@noll2020]. Given the above, data for national individualism-collectivism will be used to control for worldview. Though Hofstede’s data [@hofstede2015] is a popular source, it is outdated (collected between the 1960s and 1970s) and its validity is lacking [@blodgett2008; @gerlach2021]. A more recent dataset synthesizing Hofstede’s dimensions with others’ and validated using the World and European Values Surveys will be used [@beugelsdijk2018]. The measure ranges from 0 to 100, with 0 being a completely collectivist society and 100 being a completely individualist society. Missing data for Macao will be based on data for China. Missing data for Costa Rica, Israel, Luxembourg, and Panama will be based on the collectivism-individualism index from the Hofstede 2015 data matrix [@hofstede2015]. Data for Brunei, Liechtenstein, Mauritius, and the United Arab Emirates will be imputed. Final data will be grand mean-centered, with the intercept reflecting a country with average individualism-collectivism. Because this data is cross-sectional, it is considered time-invariant.

```{r}
all_data %>%
  ggplot(aes(x=collectivism_individualism, y=co2_lag, color=oecd))+
  geom_point()
```


**Region**. There is the possibility that countries located near each other may exhibit similar patterns in terms of either CO~2~ emissions or scientific literacy scores. This may be due to shared culture, language, economic or education systems. To control for this potential neighbor influence, UN Sustainable Development Goal regional groupings are included in the model [@unregions]. Each country's region is indicated in \@ref(tab:sltable) in Appendix A.


```{r}
all_data %>%
  ggplot(aes(x=year, y=co2_lag, color=oecd))+
  stat_summary(geom="smooth", fun="mean")+
  facet_wrap(~sdg_region, scales = "free_y")
```


```{r vardesc, tab.cap = "Descriptive Statistics for All Data", echo=FALSE, message=FALSE, warning=FALSE}
load("data/final data/table_figure_data.Rdata")

var_summary_table %>%
  flex() %>%
  autofit %>%
  font(fontname = "Times New Roman", part="all")
```

Figure \@ref(fig:allcor) shows a correlation plot for all continuous variables. Correlation matrices were estimated separately per year and then averaged. Several variables show moderate to high correlations. For example, corruption is correlated with scientific literacy (-.68), GDP-PPP (-.70), and democracy (-.62). Likewise, Collectivism-Individualism also shows strong correlations with scientific literacy (.61), GDP (.59), manufacturing as a percentage of GPD (-.65), left-right political orientation (.61), and democracy (-.62). 

An OLS model was used to statistically assess multicollinearity. The results indicate some variables had somewhat high variance inflation factors (VIF), e.g., the corruption index (6.02). These VIFs provide evidence of multicollinearity, which can which can inflate standard errors. Because all VIFs are below 10, multicollinearity may not be a major problem. In addition, the highest VIFs are among control variables, which will not effect the standard error of the key independent variable [@darlington2017]. However, even scientific literacy has a moderately high VIF at 3.63. When removing corruption from the model, this VIF falls to 2.4, suggesting a decrease in the inflation of scientific literacy's standard errors would occur. As scientific literacy is the key independent variable, the corruption index was removed from further analyses.

```{r allcor, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Correlations of all Continuous Variables, Averaged Over Time"}
library(corrplot)
corrplot::corrplot.mixed(cor_data, upper = "circle", 
                         tl.pos = "lt", lower.col = "black",
                         number.cex = 1, upper.col = COL2('PuOr', 10),
                         lower="number", tl.col = 'black')
```

```{r vif, tab.cap="Variance Inflation Factors for Independent Variables"}
load("data/final data/modeling_data.Rdata")

vif_check$vif_t %>% as.data.frame() %>%
  left_join(vif_check_wo_corruption$vif_t, by="Variables") %>%
  select(1,3, 5) %>%
  mutate_at(vars("VIF.x", "VIF.y"), ~round(.,3))  %>%
  rename("VIF" = VIF.x,
         "VIF (without corruption variable" = VIF.y) %>%
  mutate(
      Variables = case_when(
        Variables == "sl_total" ~ "Scientific Literacy (All)",
        Variables == "sl_female" ~ "Scientific Literacy (Female)",
        Variables == "pop" ~ "Population",
        Variables == "gdp" ~ "GDP-PPP (US$2015)",
        Variables == "exports" ~ "Exports as % of GDP",
        Variables == "mfg" ~ "Mfg. as % of GDP",
        Variables == "gini" ~ "Gini",
        Variables == "right_left" ~ "Right-Left Orientation",
        Variables == "democracy" ~ "Democracy Index",
        Variables == "corruption" ~ "Corruption Index",
        Variables == "net_enrollment_corrected" ~ "Net Enrollment",
        Variables == "collectivism_individualism" ~
          "Collectivism-Individualism")) %>%
  flextable() %>%
  autofit()
```


## Missing Data

Missing data ranges from 2% to almost 10%. Missing data will be imputed using a joint modeling approach. Multiple imputation is considered a modern and effective method for imputing missing data for cross-sectional analyses. However, for longitudinal data, standard multiple imputation may not be sufficient. Among a variety of possible imputation methods multiple imputation by chained equations (MICE) and joint modeling (JM) produce the least biased results for data measured at regular intervals [@huque2018]. A joint modeling approach will be implemented for this dissertation, as data is measured at regular 3-year intervals. The `JointAI` package will be used to facilitate simultaneous imputation and analysis [@erler2021]. This specific approach estimates sub-models for each variable in the data, with the ability to specify unique linear or non-linear specifications to aid in the imputation of each submodel. All level-1 time-varying covariates are imputed using linear mixed models while level-2 country-level variables are imputed with a linear model. 


## Data Analysis and Model Building

Data analysis will begin with univariate data exploration, specifically data visualizations of growth over time for carbon emissions and scientific literacy. The purpose of these visualizations will be to determine whether growth in scientific literacy is linear or takes on other shapes, such as quadratic or cubic. Any non-linear patterns will be accounted for and tested in the modeling process using likelihood ratio tests. In addition, correlations between covariates will be assessed to ensure lack of multicollinearity prior to modeling. This correlation will be assessed by time (e.g., correlations for 2006, for 2009, etc.). Any highly correlated variables will be removed or modified prior to  analysis.


All modeling will be done using the `lme4` R package [@bates2010]. Models will be fit using maximum likelihood (ML) estimation, which is appropriate for comparing models fit with different fixed effects [@hoffman2015, p. 294; @peugh2010]. Modeling will begin by fitting an unconditional growth model that contains only emissions and time. This will establish a baseline model from which to understand the effects of adding additional predictors. The intraclass correlation (ICC) will be assessed to determine the percentage of variation in CO~2~ between and within countries, controlling for time [@hoffman2015, p. 162]. The independent variable of scientific literacy will be added to subsequent models, first as a fixed effect and then as random and fixed effects. Likelihood ratio tests between models will be used to determine whether the addition of random slopes or non-linear time effects improve model fit. As additional predictors are added, the proportion of variance explained will be computed to determine the effects of their addition. A global pseudo-$R^2$ value will also be used to assess explantory power of the models.

A conditional growth model with time-varying and time-invariant predictors will directly address the first two research questions. This model will help determine 1) the relationship between scientific literacy and CO~2~ emissions per capita, controlling for other factors; and 2) whether this relationship varies for developed and less-developed countries, which will be assessed using the OECD variable. This model, which includes a set of time-varying statistical controls, *X*, will be specified as follows:

:::{custom-style="Equation Area"}
**Level 1**: $CO_2 = \beta_{0i} + \beta_{1i}(TIME)+\beta_{2i}(SL_{within})+e_{ti}$

**Level 2**: $\beta_{0i} = \gamma_{00} + \gamma_{01}(SL_{between})+\gamma_{02}(OECD)+\gamma_{3...n}(X)+U_{0i}$
$\beta_{1i}=\gamma_{10} + U_{1i}$
$beta_{2i}=\gamma_{20}+U_{2i}$

**Composite**: $CO_2 = \gamma_{00}+\gamma_{10}(TIME)+\gamma_{20}(SL_{within}) + \gamma_{01}(SL_{between})+\gamma_{02}(OECD)+\gamma_{3...n}(X)+e_{ti}+U_{0i}+U_{1i}+U_{2i}$.
:::


To address research question three regarding the effects of gender, two additional models (a male model and a female model) will be estimated with gender-specific scientific literacy scores rather than overall country scores. These will specified using the same equations above. A formal *Z*-test for the equality of regression coefficients will be conducted to assess if there are any differential effects between male and female scientific literacy scores on CO~2~ per capita holding all other variables constant [@clogg1995; @piquero2016]. The *Z*-test will be specified as follows:


:::{custom-style="Equation"}
$Z = \frac{\beta_{slf}-\beta_{slm}}{\sqrt{SE\beta_{slf}-SE\beta_{slm}}}$,
:::

:::{custom-style="Body Text 2"}
where $\beta$ refers to the regression coefficient for female (*slf*) or male (*slm*) scientific literacy), and $SE\beta$ refers to regression standard errors. This *Z*-test is based on recommendations in @piquero2016 (equation 4).
:::





@furr2014; @desjardins2018

`r officer::run_pagebreak()`
